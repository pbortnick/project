<p id="notice"><%= notice %></p>

<h1><%= @category.title %></h1>

<%= link_to "New Post", new_category_post_path(@category) %>

<p>Posts:</p>
<% @category.posts.each do |post| %>
  <h2><%= post.title %></h2>
  <!-- truncate post body to 30 char -->
  <div id="body-<%= post.id %>"><%= truncate post.body %></div>
  <!-- if body length is greater than 35 characters, view rest of post body by clicking button (see app/assets/javascripts/post.js)-->
  <% if post.body.length > 30 %>
    <button class="more" data-id="<%= post.id %>">View More</button>
  <% end %>
  <div id="image-<%= post.id %>">
    <% if post.avatar.present? %>
      <%= image_tag post.avatar.url alt=" "%>
    <% end %>
  </div>
<% end %>


<%= link_to 'Back', categories_path %>

<script type="text/javascript" charset="utf-8">
  $(function() {
    $(".more").on('click', function() {
      var id = $(this).data("id");
      $.get("/posts/" + id + "/body", function(data) {
        // Replace text of body-id div
        $("#body-" + id).text(data);
      });
    });
  });
</script>
